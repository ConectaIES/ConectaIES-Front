<!-- Botão Flutuante -->
<button 
  class="accessibility-fab"
  (click)="togglePanel()"
  [attr.aria-expanded]="isOpen()"
  aria-label="Abrir painel de acessibilidade"
  matTooltip="Acessibilidade">
  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <circle cx="12" cy="12" r="10"/>
    <circle cx="12" cy="8" r="1.5" fill="currentColor"/>
    <path d="M8 14h8"/>
    <path d="M10 11l-2 7"/>
    <path d="M14 11l2 7"/>
  </svg>
</button>

<!-- Painel de Acessibilidade -->
@if (isOpen()) {
  <!-- Overlay para fechar -->
  <div class="panel-overlay" (click)="closePanel()"></div>
  
  <!-- Conteúdo do Painel -->
  <div class="accessibility-panel" role="dialog" aria-labelledby="accessibility-title">
    <div class="panel-content">
      <div class="panel-header">
        <h2 id="accessibility-title">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <circle cx="12" cy="8" r="1.5" fill="currentColor"/>
            <path d="M8 14h8"/>
            <path d="M10 11l-2 7"/>
            <path d="M14 11l2 7"/>
          </svg>
          Acessibilidade
        </h2>
        <button 
          class="close-btn" 
          (click)="closePanel()"
          aria-label="Fechar painel de acessibilidade">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>

      <!-- Seção Modo Noturno -->
      <div class="accessibility-section">
        <h3>Modo Noturno</h3>
        <p class="section-description">Reduza o brilho da tela em ambientes escuros</p>
        
        <div class="theme-toggle-container">
          <button 
            class="theme-toggle-btn"
            [class.active]="!accessibilityService.darkMode()"
            (click)="accessibilityService.disableDarkMode()"
            aria-label="Ativar modo claro">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"/>
              <line x1="12" y1="1" x2="12" y2="3"/>
              <line x1="12" y1="21" x2="12" y2="23"/>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
              <line x1="1" y1="12" x2="3" y2="12"/>
              <line x1="21" y1="12" x2="23" y2="12"/>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
            </svg>
            <span>Claro</span>
          </button>

          <button 
            class="theme-toggle-btn"
            [class.active]="accessibilityService.darkMode()"
            (click)="accessibilityService.enableDarkMode()"
            aria-label="Ativar modo escuro">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
            <span>Escuro</span>
          </button>
        </div>
      </div>

      <!-- Seção de Tamanho da Fonte -->
      <div class="accessibility-section">
        <h3>Tamanho do Texto</h3>
        <p class="section-description">Ajuste o tamanho da fonte para melhor leitura</p>
        
        <div class="font-controls">
          <button 
            class="control-btn"
            (click)="accessibilityService.decreaseFontSize()"
            [disabled]="!canDecrease"
            aria-label="Diminuir tamanho da fonte">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 7h16M4 12h16M4 17h10"/>
              <circle cx="19" cy="17" r="3"/>
              <path d="M17.5 17h3"/>
            </svg>
            <span>Diminuir</span>
          </button>

          <div class="font-size-display">
            @if (accessibilityService.fontSize() === 'small') {
              <span class="size-indicator small">A-</span>
              <span class="size-label">Pequeno</span>
            } @else if (accessibilityService.fontSize() === 'normal') {
              <span class="size-indicator normal">A</span>
              <span class="size-label">Normal</span>
            } @else {
              <span class="size-indicator large">A+</span>
              <span class="size-label">Grande</span>
            }
          </div>

          <button 
            class="control-btn"
            (click)="accessibilityService.increaseFontSize()"
            [disabled]="!canIncrease"
            aria-label="Aumentar tamanho da fonte">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 7h16M4 12h16M4 17h10"/>
              <circle cx="19" cy="17" r="3"/>
              <path d="M19 15.5v3M17.5 17h3"/>
            </svg>
            <span>Aumentar</span>
          </button>
        </div>

        <button 
          class="reset-btn"
          (click)="accessibilityService.resetFontSize()"
          aria-label="Restaurar tamanho padrão da fonte">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
            <path d="M21 3v5h-5"/>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
            <path d="M3 21v-5h5"/>
          </svg>
          Restaurar Padrão
        </button>
      </div>

      <!-- Seção Atalhos de Teclado -->
      <div class="accessibility-section keyboard-section">
        <h3>Atalhos de Teclado</h3>
        <p class="section-description">Use o teclado para navegar rapidamente</p>
        
        <div class="shortcuts-list">
          <div class="shortcut-item">
            <div class="shortcut-keys">
              <kbd>Alt</kbd> + <kbd>A</kbd>
            </div>
            <span class="shortcut-description">Abrir/Fechar painel</span>
          </div>
          
          <div class="shortcut-item">
            <div class="shortcut-keys">
              <kbd>Esc</kbd>
            </div>
            <span class="shortcut-description">Fechar painel</span>
          </div>
          
          <div class="shortcut-item">
            <div class="shortcut-keys">
              <kbd>Ctrl</kbd> + <kbd>+</kbd>
            </div>
            <span class="shortcut-description">Aumentar fonte</span>
          </div>
          
          <div class="shortcut-item">
            <div class="shortcut-keys">
              <kbd>Ctrl</kbd> + <kbd>-</kbd>
            </div>
            <span class="shortcut-description">Diminuir fonte</span>
          </div>
          
          <div class="shortcut-item">
            <div class="shortcut-keys">
              <kbd>Ctrl</kbd> + <kbd>0</kbd>
            </div>
            <span class="shortcut-description">Resetar fonte</span>
          </div>
          
          <div class="shortcut-item">
            <div class="shortcut-keys">
              <kbd>Ctrl</kbd> + <kbd>D</kbd>
            </div>
            <span class="shortcut-description">Alternar tema</span>
          </div>
          
          <div class="shortcut-item">
            <div class="shortcut-keys">
              <kbd>Tab</kbd>
            </div>
            <span class="shortcut-description">Navegar entre elementos</span>
          </div>
        </div>
      </div>

      <!-- Seção VLibras -->
      <div class="accessibility-section vlibras-section">
        <h3>Tradução em Libras</h3>
        <p class="section-description">Ative o tradutor de Libras para acessibilidade em língua de sinais</p>
        
        <button 
          class="vlibras-btn"
          [class.active]="vLibrasActive()"
          (click)="toggleVLibras()"
          [attr.aria-label]="vLibrasActive() ? 'Desativar tradutor VLibras' : 'Ativar tradutor VLibras'">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
            <path d="M2 17l10 5 10-5"/>
            <path d="M2 12l10 5 10-5"/>
          </svg>
          <span>{{ vLibrasActive() ? 'Desativar VLibras' : 'Ativar VLibras' }}</span>
          @if (vLibrasActive()) {
            <svg class="check-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <path d="M20 6L9 17l-5-5"/>
            </svg>
          } @else {
            <svg class="arrow-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
          }
        </button>
      </div>

      <!-- Informações Adicionais -->
      <div class="panel-footer">
        <p>Use os atalhos de teclado para uma navegação mais rápida e acessível</p>
      </div>
    </div>
  </div>
}