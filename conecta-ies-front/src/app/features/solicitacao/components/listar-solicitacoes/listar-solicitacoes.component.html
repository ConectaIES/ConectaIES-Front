<div class="listar-solicitacoes-container">
  <div class="page-header">
    <div class="header-content">
      <div class="header-text">
        <h1>Minhas Solicitações</h1>
        <p>Acompanhe o status de todas as suas solicitações de acessibilidade</p>
      </div>
      <button class="btn btn-primary" [matMenuTriggerFor]="menuSolicitacao">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        <span>Nova Solicitação</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="6 9 12 15 18 9"/>
        </svg>
      </button>
    </div>
    
    <mat-menu #menuSolicitacao="matMenu">
      <button mat-menu-item (click)="abrirFormulario('chamado')">
        <mat-icon>phone</mat-icon>
        <span>Chamado Personalizado</span>
      </button>
      <button mat-menu-item (click)="abrirFormulario('sugestao')">
        <mat-icon>star</mat-icon>
        <span>Sugestão de Melhoria</span>
      </button>
      <button mat-menu-item (click)="abrirFormulario('apoio')">
        <mat-icon>accessibility</mat-icon>
        <span>Solicitar Apoio</span>
      </button>
      <button mat-menu-item (click)="abrirFormulario('problema')">
        <mat-icon>warning</mat-icon>
        <span>Reportar Problema</span>
      </button>
    </mat-menu>
  </div>

  @if (carregando()) {
    <div class="loading-state">
      <svg class="spinner" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <circle cx="12" cy="12" r="10" stroke-width="4" fill="none"/>
      </svg>
      <p>Carregando solicitações...</p>
    </div>
  } @else if (solicitacoes().length === 0) {
    <div class="empty-state">
      <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="empty-icon">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
        <line x1="12" y1="18" x2="12" y2="12"/>
        <line x1="9" y1="15" x2="15" y2="15"/>
      </svg>
      <h2>Nenhuma solicitação encontrada</h2>
      <p>Você ainda não possui solicitações de acessibilidade. Crie sua primeira solicitação agora!</p>
      <button class="btn btn-primary" [matMenuTriggerFor]="menuSolicitacao">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        <span>Criar Primeira Solicitação</span>
      </button>
    </div>
  } @else {
    <div class="solicitacoes-grid">
      @for (solicitacao of solicitacoes(); track solicitacao.id) {
        <div class="solicitacao-card" (click)="verDetalhes(solicitacao.id)">
          <div class="card-header">
            <div class="card-title-section">
              <h3>{{ solicitacao.titulo }}</h3>
              <span class="protocolo">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                  <polyline points="14 2 14 8 20 8"/>
                </svg>
                {{ solicitacao.protocolo }}
              </span>
            </div>
            <mat-chip [highlighted]="true" [color]="getStatusColor(solicitacao.status)" class="status-chip">
              {{ getStatusLabel(solicitacao.status) }}
            </mat-chip>
          </div>

          <div class="card-content">
            <p class="descricao">{{ solicitacao.descricao }}</p>
            <div class="card-footer">
              <div class="data-info">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
                <span>{{ solicitacao.updatedAt | date:'dd/MM/yyyy HH:mm' }}</span>
              </div>
              <button class="btn-ver-detalhes">
                <span>Ver Detalhes</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M5 12h14M12 5l7 7-7 7"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>
